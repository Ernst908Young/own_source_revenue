<?php	class InfowizardQuestionMasterExt extends SpApplications{	public static function getMasterList($dbtable=null,$key=null,$value=null,$active=null,$isactivevalue=null){           		if(empty($active)){  $active="is_active"; }		if(empty($isactivevalue)){ $isactivevalue="Y"; }		$connection=Yii::app()->db;		$sql = "SELECT $key,$value FROM $dbtable where $active=:$active";		$command=$connection->createCommand($sql);		$command->bindParam(":$active",$isactivevalue,PDO::PARAM_INT);		$allData=$command->queryAll();		$listData = array();		if(!empty($allData)){			foreach ($allData as $data){ 				$k=$data[$key];				$listData[$k]=$data[$value];			}			return $listData;		}	}		public static function getCommentRevertedCaf($submission_id=null){  		$connection=Yii::app()->db;	    $sql = "SELECT approver_comments,created_date_time FROM `bo_application_flow_logs` WHERE `application_status` = 'RBI' AND submission_id=$submission_id";		$command=$connection->createCommand($sql);		$allData=$command->queryAll();		return $allData;	}	 public static function getTimelineMaster(){  		$connection=Yii::app()->db;	    $sql = "SELECT id,name FROM du_timeline_commencement_master where status='Y'";		$command=$connection->createCommand($sql);		$allData=$command->queryAll();		return $allData;	}		 public static function getTimelineName($id=null){  		$connection=Yii::app()->db;	    $sql = "SELECT name FROM du_timeline_commencement_master where id='$id'";		$command=$connection->createCommand($sql);		$allData=$command->queryRow();		return $allData['name'];	}	          public static function getMasterName($dbtable=null,$key=null,$value=null,$id=null){                    		$connection=Yii::app()->db;		$isactive='Y'; 	        $sql = "SELECT $value FROM $dbtable where $id=$key";		$command=$connection->createCommand($sql);		$allData=$command->queryRow();	                		return $allData[$value];	}                public static function getMasterListIndustrial($dbtable=null,$key=null,$value=null,$active=null,$isactivevalue=null,$matchval=null){           		if(empty($active)){  $active="is_active"; }		if(empty($isactivevalue)){ $isactivevalue="Y"; }		$connection=Yii::app()->db;		$sql = "SELECT $key,$value FROM $dbtable where $active='Y' and land_type ='".$matchval."' Order By id ASC";		$command=$connection->createCommand($sql);		$command->bindParam(":$active",$isactivevalue,PDO::PARAM_INT);		$allData=$command->queryAll();			$listData = array();		foreach ($allData as $data){			$k=$data[$key];			$listData[$k]=$data[$value];		}		return $listData;	}                public static function getDeptMasterList($key=null,$value=null,$active=null,$isactivevalue=null){           	                     if(empty($active)){  $active="is_issuerby_active"; }                     if(empty($isactivevalue)){ $isactivevalue="Y"; }		$connection=Yii::app()->db;			        $sql = "SELECT $key,$value FROM bo_infowizard_issuerby_master Right join bo_departments on bo_infowizard_issuerby_master.abb = bo_departments.infowiz_short_code";		$command=$connection->createCommand($sql);		$command->bindParam(":$active",$isactivevalue,PDO::PARAM_INT);		$allData=$command->queryAll();					$listData = array();                foreach ($allData as $data){                    $k=$data[$key];                    $listData[$k]=$data[$value];                                    }						return $listData;	}		  public static function getValidatedPisMou($id=null){                    		$connection=Yii::app()->db;		$isactive='Y'; 	    $sql = "SELECT parent_id FROM du_ip_admin_pis_mou_upload where parent_id = $id";		$command=$connection->createCommand($sql);		$allData=$command->queryRow();	                		if(isset($allData) && !empty($allData))		{			return true;		}else{			return false;		}	}		public static function getPropsedDitrictList($dbtable = null, $key = null, $value = null, $state_code = null, $active = null, $isactivevalue = null) {        if (empty($active)) {            $active = "is_active";        } if (empty($isactivevalue)) {            $isactivevalue = "Y";        } $connection = Yii::app()->db;        $sql = "SELECT $key,$value FROM $dbtable where $active=:$active";        $command = $connection->createCommand($sql);        $command->bindParam(":$active", $isactivevalue, PDO::PARAM_INT);        $allData = $command->queryAll();        $listData = array();		$listData['718'] = 'Entire State';		$listData['719'] = 'Not decided yet';        foreach ($allData as $data) {            $k = $data[$key];            $listData[$k] = ucfirst($data[$value]);        } 				return $listData;    }	public static function getCAFAppliedOn($cafid=null){  		$connection=Yii::app()->db;	    $sql = "SELECT created_date_time FROM bo_application_flow_logs where submission_id='$cafid' AND application_status='ISA'";		$command=$connection->createCommand($sql);		$allData=$command->queryRow();		if(isset($allData['created_date_time']) && !empty($allData['created_date_time']))		return $allData['created_date_time'];		else		return  false;	}			public static function getCAFPendingDays($cafid=null){  		$connection=Yii::app()->db;	    $sql = "SELECT DATEDIFF(NOW(), application_updated_date_time) as Days FROM bo_application_submission where submission_id='$cafid' AND application_status IN ('P','F')";		$command=$connection->createCommand($sql);		$allData=$command->queryRow();		$currentDate = date('Y-m-d H:i:s');		if(isset($allData['Days']) && !empty($allData['Days']))		return $pendingDays = $allData['Days'];		else		return  false;	}			public static function getCAFPendingWithDept($cafid=null){  		$connection=Yii::app()->db;	    $sql = "SELECT bo_departments.department_name FROM bo_application_forward_level LEFT JOIN bo_departments ON bo_departments.dept_id = bo_application_forward_level.forwarded_dept_id where bo_application_forward_level.app_Sub_id='$cafid' AND bo_application_forward_level.approv_status IN ('P')";		$command=$connection->createCommand($sql);		$allData=$command->queryAll();				if(isset($allData) && !empty($allData))		{			foreach($allData as $key=>$val)			{				$deptArr[] = $val['department_name'];			}			return $deptStr = implode(", ",$deptArr);			}else{			return  false;				}			}		public static function getCAFReceivedWithDept($cafid=null){  		$connection=Yii::app()->db;	    $sql = "SELECT bo_departments.department_name FROM bo_application_forward_level LEFT JOIN bo_departments ON bo_departments.dept_id = bo_application_forward_level.forwarded_dept_id where bo_application_forward_level.app_Sub_id='$cafid' AND bo_application_forward_level.approv_status IN ('V')";		$command=$connection->createCommand($sql);		$allData=$command->queryAll();				if(isset($allData) && !empty($allData))		{			foreach($allData as $key=>$val)			{				$deptArr[] = $val['department_name'];			}			return $deptStr = implode(", ",$deptArr);			}else{			return  false;				}			}		/* For New CAF use functions */		public static function getNewCAFAppliedOn($cafid=null){  		$connection=Yii::app()->db;	    $sql = "SELECT application_created_date FROM bo_infowiz_form_builder_investor_logs where submission_id='$cafid' AND application_status='P'";		$command=$connection->createCommand($sql);		$allData=$command->queryRow();		if(isset($allData['application_created_date']) && !empty($allData['application_created_date']))		return $allData['application_created_date'];		else		return  false;	}	public static function getNewCAFPendingDays($cafid=null){  		$connection=Yii::app()->db;	    $sql = "SELECT DATEDIFF(NOW(), application_updated_date_time) as Days FROM bo_new_application_submission where submission_id='$cafid' AND application_status IN ('P','F')";		$command=$connection->createCommand($sql);		$allData=$command->queryRow();		$currentDate = date('Y-m-d H:i:s');		if(isset($allData['Days']) && !empty($allData['Days']))		return $pendingDays = $allData['Days'];		else		return  false;	}		public static function getNewCAFPendingWithDept($cafid=null){  		$connection=Yii::app()->db;	    $sql = "SELECT bo_departments.department_name FROM bo_infowiz_formbuilder_application_forward_level LEFT JOIN bo_departments ON bo_departments.dept_id = bo_infowiz_formbuilder_application_forward_level.forwarded_dept_id where bo_infowiz_formbuilder_application_forward_level.app_Sub_id='$cafid' AND bo_infowiz_formbuilder_application_forward_level.approv_status IN ('P')";		$command=$connection->createCommand($sql);		$allData=$command->queryAll();				if(isset($allData) && !empty($allData))		{			foreach($allData as $key=>$val)			{				$deptArr[] = $val['department_name'];			}			return $deptStr = implode(", ",$deptArr);			}else{			return  false;				}			}		public static function getNewCAFReceivedWithDept($cafid=null){  		$connection=Yii::app()->db;	    $sql = "SELECT bo_departments.department_name FROM bo_infowiz_formbuilder_application_forward_level LEFT JOIN bo_departments ON bo_departments.dept_id = bo_infowiz_formbuilder_application_forward_level.forwarded_dept_id where bo_infowiz_formbuilder_application_forward_level.app_Sub_id='$cafid' AND bo_infowiz_formbuilder_application_forward_level.approv_status IN ('V')";		$command=$connection->createCommand($sql);		$allData=$command->queryAll();				if(isset($allData) && !empty($allData))		{			foreach($allData as $key=>$val)			{				$deptArr[] = $val['department_name'];			}			return $deptStr = implode(", ",$deptArr);			}else{			return  false;				}			}		public static function getCommentRevertedNewCaf($submission_id=null){  		$connection=Yii::app()->db;	    $sql = "SELECT department_comment,created FROM `bo_infowiz_form_builder_application_log` WHERE `action_status` = 'H' AND submission_id=$submission_id";		$command=$connection->createCommand($sql);		$allData=$command->queryAll();		return $allData;	}}		?>